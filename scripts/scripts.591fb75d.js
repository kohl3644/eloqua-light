"use strict";function Base64(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(b){var c,d,e,f,g,h="",i="",j="",k=0;do c=b.charCodeAt(k++),d=b.charCodeAt(k++),i=b.charCodeAt(k++),e=c>>2,f=(3&c)<<4|d>>4,g=(15&d)<<2|i>>6,j=63&i,isNaN(d)?g=j=64:isNaN(i)&&(j=64),h=h+a.charAt(e)+a.charAt(f)+a.charAt(g)+a.charAt(j),c=d=i="",e=f=g=j="";while(k<b.length);return h},decode:function(b){var c,d,e,f,g,h="",i="",j="",k=0,l=/[^A-Za-z0-9\+\/\=]/g;l.exec(b)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=a.indexOf(b.charAt(k++)),f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),j=a.indexOf(b.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!=g&&(h+=String.fromCharCode(d)),64!=j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j="";while(k<b.length);return h}}}function HttpRequestInterceptor(a){return{request:function(b){var c="ec4uSandbox",d="Julian.Kohlhaas",e="OracleSC30";b.headers.Authorization="Basic "+a.encode(c+"\\"+d+":"+e);a.encode(c+"\\"+d+":"+e);return b.headers["Access-Control-Allow-Origin"]="*",b.headers["Access-Control-Allow-Credentials"]="true",b.headers.Accept="application/json;odata=verbose",b.headers["Access-Control-Allow-Methods"]="PATCH, GET, HEAD, OPTIONS, POST, PUT",b.headers["Access-Control-Allow-Headers"]="Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers",b.headers["Content-Type"]="application/json",b.headers["Access-Control-Allow-Origin"]="http://localhost:9000",b}}}function CampaignController(a,b,c,d,e,f,g,h,i,j){function k(){var a=c.hide()||g.when(!0);a.then(function(){b("left").toggle()})}function l(b){r.selected=angular.isNumber(b)?$scope.campaigns[b]:b,o(r.selected),n(r.selected),a.getPermission(b.id).then(function(a){r.campaignPermission=a}),r.toggleList()}function m(a){d.path(a)}function n(a){r.selected.segments=[],a.elements.forEach(function(a){"CampaignSegment"===a.type&&r.selected.segments.push(a)})}function o(a){r.selected.emails=[],console.log(a.elements),a.elements.forEach(function(a){"CampaignEmail"==a.type&&r.selected.emails.push(a)})}function p(b){var c;b.name=b.name+"_jk_pt",a.copyCampaign(b).then(function(a){c=a;var b=[];angular.forEach(c.elements,function(a,c,d){"CampaignEmailClickthroughRule"===a.type&&(console.log("Found!"),b.push(c))});var d=[];angular.forEach(c.elements,function(a,e,f){var j=g.defer();d.push(j.promise),"CampaignSegment"===a.type&&h.getMinimalSegment(a.segmentId).then(function(b){b.name=b.name+"_jk",h.copySegment(b).then(function(b){a.segmentId=b.id,console.log("Neues Segment mit der ID"+a.segmentId),j.resolve()})}),"CampaignEmail"===a.type?i.getMinimalSingleMail(a.emailId).then(function(d){d.name=d.name+"_jk",i.copyEmail(d).then(function(d){a.emailId=d.id,console.log("Neue Email mit der ID"+a.emailId),b.length>0&&(console.log("Update"),c.elements[b[0]].emailId=d.id),j.resolve()})}):j.resolve()}),g.all(d).then(function(){console.log(c)})})}function q(b){function c(){a.getPermission(b.id).then(function(c){angular.forEach(c.elements,function(c,d,e){"Julian Kohlhaas"===c.recipient.name&&(c.patchMethod="edit",c.permissions=["Retrieve","SetSecurity"],console.log(c),a.updatePermission(b.id,c).then(function(a){}))})})}var d=j.confirm().clickOutsideToClose(!1).title("Decline Campaign").textContent("Please notice that you can´t access this campaign in the future anymore. Do you want to continue?").ok("DO IT!").cancel("Nahhh let it be");j.show(d).then(c,function(){})}var r=this;(function(){function a(a,b,c,d,e,f,g,h){this.id=a,this.name=b,this.elements=c,this.startAt=d,this.endAt=e,this.currentStatus=f,this.actualCost=g,this.budgetCost=h}return a})();r.selected=null,r.campaigns=[],r.campaignPermission=null,r.changeView=m,r.participate=p,r.decline=q,r.selectCampaign=l,r.toggleList=k,a.getAllCampaigns().then(function(a){r.campaigns=[].concat(a),r.selected=a[0],r.selectCampaign(r.selected)})}function EmailEditingController(a,b,c,d,e,f){function g(){console.log("Load beginn")}function h(){console.log("ng-include geladen")}function i(){console.log(angular.element(document.querySelector("emailTemplate")))}function j(a){"StructuredHtmlContent"===a.htmlContent.type?c.get("template.html")!=a.htmlContent.htmlBody&&(c.put("template.html",a.htmlContent.htmlBody),f.reload()):c.get("template.html")!=a.htmlContent.html&&(c.put("template.html",a.htmlContent.html),f.reload())}var k=this;k.content=null,k.childOnLoad=g,k.postLoad=h,k.saveEmail=i;var l=e.id;a.user={email:"test@email.de",title:"Developer"},b.getSingleMail(l).then(function(a){console.log("Service läuft"),j(a)})}function campaignService(a,b,c,d){function e(){function a(a){var b=a.data.elements;return b}function c(a){}return b.get("https://secure.p03.eloqua.com/API/REST/2.0/assets/campaigns?depth=complete&count=10&search=*test*").then(a)["catch"](c)}function f(){}function g(){}function h(a){function c(a){var b=a.data;return console.log("Ende Kopieren"),b}function d(a){}return b.post("https://secure.p03.eloqua.com/API/REST/2.0/assets/campaign/"+a.id.toString()+"/copy",a).then(c)["catch"](d)}function i(a){function c(a){var b=a.data;return b}function d(a){}var e=a.id;return b.put("https://secure.p03.eloqua.com/API/REST/2.0/assets/campaign/"+e.toString(),a).then(c)["catch"](d)}function j(b){var d=0,e=a.defer();b.elements.forEach(function(a,f,g){return"CampaignSegment"===a.type&&c.getMinimalSegment(a.segmentId).then(function(b){b.name=b.name+"_jk",c.copySegment(b).then(function(b){a.segmentId=b.id,console.log("Innerhalb der Funktion Segment")})}),d++,d===g.length?(e.resolve(b),console.log("Ende Segment"),e.promise):void 0})}function k(b){var c=0,e=a.defer();console.log(b),b.elements.forEach(function(a,f,g){return"CampaignEmail"===a.type&&d.getMinimalSingleMail(a.emailId).then(function(b){b.name=b.name+"_jk",d.copyEmail(b).then(function(b){a.emailId=b.id,console.log("Innerhalb der Campign Email Funktion")})}),c++,c===g.length?(e.resolve(b),console.log("Ende Email"),e.promise):void 0})}function l(a){function c(a){var b=a.data;return b}function d(a){}return b.get("https://secure.p03.eloqua.com/API/REST/2.0/assets/campaign/"+a.toString()+"/security/grants").then(c)["catch"](d)}function m(a,c){function d(a){var b=a.data;return b}function e(a){}return b.post("https://secure.p03.eloqua.com/API/REST/2.0/assets/campaign/"+a.toString()+"/security/grants",c,{headers:{"X-HTTP-Method-Override":"PATCH"}}).then(d)["catch"](e)}var n={getAllCampaigns:e,getEmailsByCampaign:g,getSingleCampaign:f,copyCampaign:h,updateCampaign:i,getPermission:l,updatePermission:m,replaceCampaignEmails:k,replaceCampaignSegments:j};return n}function CampaignMemberListController(a,b,c,d,e){function f(a){a.excluded===!0?(a.excluded=!1,a.buttonName="remove_circle",a.buttonStyle="remove",g(a)):(a.excluded=!0,a.buttonName="add_circle",a.buttonStyle="add",h(a))}function g(a){i.segment.elements.forEach(function(b){"false"===b.isIncluded&&(b.list.membershipDeletions=[],b.list.membershipDeletions.push(a.contactId))}),d.updateSegment(i.segment).then(function(a){i.segment=a}),e.show(e.alert().clickOutsideToClose(!0).title("Added Member").textContent("You successfully added "+a.name+" from the Campaign Segment!").ok("Got it!"))}function h(a){console.log(i.segment),i.segment.elements.forEach(function(b){"false"===b.isIncluded&&(b.list.membershipAdditions=[],b.list.membershipAdditions.push(a.contactId))}),d.updateSegment(i.segment).then(function(a){i.segment=a}),e.show(e.alert().clickOutsideToClose(!0).title("Removed Member").textContent("You successfully removed "+a.name+" from the Campaign Segment!").ok("Got it!"))}var i=this,j=c.id;i.memberList=[],i.displayedMemberList=[],i.updateMember=f,i.segment,d.getSegment(j).then(function(a){i.segment=a}),console.log(j),d.getSegmentMembers(j).then(function(a){i.memberList=i.memberList.concat(a),i.displayedMemberList=i.memberList.concat(a)}),d.getExcludedSegmentMembers(j).then(function(a){i.memberList=i.memberList.concat(a),i.displayedMemberList=i.memberList.concat(a)})}function emailService(a,b,c){function d(a){function c(a){return console.log(a.data),a.data}function d(a){console.log(a.data)}return b.get("https://secure.p03.eloqua.com/API/REST/1.0/assets/email/"+a.toString()+"?depth=complete").then(c)["catch"](d)}function e(a){function c(a){return console.log(a.data),a.data}function d(a){console.log(a.data)}return b.get("https://secure.p03.eloqua.com/API/REST/1.0/assets/email/"+a.toString()+"?depth=complete").then(c)["catch"](d)}function f(a){function c(a){var b=a.data;return b}function d(a){}var e=a.id;return a.permissions=["Retrieve","SetSecurity","Delete","Update","Activate"],b.post("https://secure.p03.eloqua.com/API/REST/2.0/assets/email/"+e.toString()+"/copy",a).then(c)["catch"](d)}function g(){}function h(){}var i={getSingleMail:d,getMinimalSingleMail:e,copyEmail:f,participateCampaign:g,declineCampaign:h};return i}function segmentService(a,b){function c(){function a(a){var b=a.data.elements;return b}function c(a){}return b.get("https://secure.p03.eloqua.com/API/REST/2.0/").then(a)["catch"](c)}function d(a){function c(a){var b=a.data;return b}function d(a){}return b.get("https://secure.p03.eloqua.com/API/REST/1.0/assets/contact/segment/"+a.toString()).then(c)["catch"](d)}function e(a){function c(a){var b=a.data;return b}function d(a){}return b.get("https://secure.p03.eloqua.com/API/REST/1.0/assets/contact/segment/"+a.toString()+"?depth=minimal").then(c)["catch"](d)}function f(a){function c(a){var b=a.data.elements;return b.forEach(function(a){a.excluded=!1,a.buttonName="remove_circle",a.buttonStyle="remove"}),b}function d(a){}return b.get("https://secure.p03.eloqua.com/API/REST/2.0/data/contact/view/100001/contacts/segment/"+a.toString()).then(c)["catch"](d)}function g(a){function c(a){var b=a.data.elements;return b.forEach(function(a){a.excluded=!0,a.buttonName="add_circle",a.buttonStyle="add"}),b}function d(a){}return b.get("https://secure.p03.eloqua.com/API/REST/2.0/data/contact/view/100001/contacts/segment/"+a.toString()+"/excluded").then(c)["catch"](d)}function h(a){function c(a){var b=a.data;return b}function d(a){}return b.put("https://secure.p03.eloqua.com/API/REST/1.0/assets/contact/segment/"+a.id.toString(),a).then(c)["catch"](d)}function i(a){function c(a){var b=a.data;return b}function d(a){}var e=a.id;return a.permissions=["Retrieve","SetSecurity","Delete","Update","Activate"],console.log(a),b.post("https://secure.p03.eloqua.com/API/REST/2.0/assets/contact/segment/"+e.toString()+"/copy",a).then(c)["catch"](d)}function j(){}var k={getAllSegments:c,getSegment:d,getMinimalSegment:e,getSegmentMembers:f,getExcludedSegmentMembers:g,updateSegment:h,copySegment:i,getAllViews:j};return k}angular.module("thesisProjectApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMaterial","smart-table"]).factory("Base64",Base64).factory("HttpRequestInterceptor",["Base64",HttpRequestInterceptor]).config(["$httpProvider",function(a){a.interceptors.push("HttpRequestInterceptor")}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/campaignInbox",{templateUrl:"views/campaign.html",controller:"CampaignController",controllerAs:"campaignCtrl"}).when("/emailEditing/:id",{templateUrl:"emailEditing.html",controller:"EmailEditingController",controllerAs:"emailEditingCtrl"}).when("/campaignMemberList/:id",{templateUrl:"views/campaignMemberList.html",controller:"CampaignMemberListController",controllerAs:"CampMemberListCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("thesisProjectApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("thesisProjectApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("thesisProjectApp").controller("CampaignController",CampaignController),CampaignController.$inject=["campaignService","$mdSidenav","$mdBottomSheet","$location","$routeParams","$templateCache","$q","segmentService","emailService","$mdDialog"],angular.module("thesisProjectApp").controller("EmailEditingController",EmailEditingController).config(["$mdThemingProvider",function(a){a.theme("docs-dark","default").primaryPalette("yellow").dark()}]),EmailEditingController.$inject=["$scope","emailService","$templateCache","$templateRequest","$routeParams","$route"],angular.module("thesisProjectApp").service("campaignService",campaignService),campaignService.$inject=["$q","$http","segmentService","emailService"],angular.module("thesisProjectApp").controller("CampaignMemberListController",CampaignMemberListController),CampaignMemberListController.$inject=["$scope","$filter","$routeParams","segmentService","$mdDialog"],angular.module("thesisProjectApp").service("emailService",emailService),emailService.$inject=["$q","$http","$routeParams"],angular.module("thesisProjectApp").service("segmentService",segmentService),segmentService.$inject=["$q","$http"],angular.module("thesisProjectApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/campaign.html",'<div layout="row"> <md-sidenav class="site-sidenav md-sidenav-left md-whiteframe-z2" md-component-id="left" md-is-locked-open="$mdMedia(\'gt-sm\')"> <md-toolbar class="md-whiteframe-z1"> <h1>Campaigns</h1> </md-toolbar> <md-list> <md-list-item ng-repeat="campaign in campaignCtrl.campaigns"> <md-button ng-click="campaignCtrl.selectCampaign(campaign)" ng-class="{\'selected\' : campaign === campaignCtrl.selected }"> <!-- <md-icon md-svg-icon="{{it.avatar}}" class="avatar"></md-icon> \n            <img ng-src = \'{{campaign.image}}\' class="avatar"> --> <div><strong>{{campaign.name}}</strong></div> <div>Status: {{campaign.currentStatus}}</div> </md-button> </md-list-item> </md-list> </md-sidenav> <div flex layout="column" tabindex="-1" role="main" class="md-whiteframe-z2"> <md-toolbar layout="row" class="md-whiteframe-z1"> <md-button class="menu" hide-gt-sm ng-click="campaignCtrl.toggleList()" aria-label="Show Campaign List"> <i class="material-icons md-36">list</i> </md-button> <h1>Content</h1> </md-toolbar> <md-content flex id="content"> <div layout="row" layout-xs="column"> <h2>{{campaignCtrl.selected.name}}</h2> <md-button class="md-raised participate" ng-click="campaignCtrl.participate(campaignCtrl.selected)">Participate</md-button> <md-button class="md-raised decline" ng-click="campaignCtrl.decline(campaignCtrl.selected)">Decline</md-button> </div> <div layout="row" layout-xs="column"> <p>Current Status: {{campaignCtrl.selected.currentStatus}}</p> </div> <div layout="row" layout-xs="column"> <md-card ng-repeat="email in campaignCtrl.selected.emails" flex-xs="" flex-gt-xs="50"> <md-card-title> <md-card-title-text> <span class="md-headline">{{email.name}}</span> <span class="md-subhead">EmailID: {{email.emailId}}</span> </md-card-title-text> <md-card-title-media> <div class="md-media-sm card-media"> <i class="material-icons md-48">mail</i> </div> </md-card-title-media> </md-card-title> <md-card-actions layout="row" layout-align="end center"> <md-button class="showMore" ng-click=" campaignCtrl.changeView(\'emailEditing/ \' + email.emailId) ">Show Mail</md-button> <!--  --> </md-card-actions> </md-card> </div> <div layout="row" layout-xs="column"> <md-card ng-repeat="segment in campaignCtrl.selected.segments" flex-xs="" flex-gt-xs="50"> <md-card-title> <md-card-title-text> <span class="md-headline">{{segment.name}}</span> <span class="md-subhead">SegmentID: {{segment.segmentId}}</span> </md-card-title-text> <md-card-title-media> <div class="md-media-sm card-media"> <i class="material-icons md-48">group</i> </div> </md-card-title-media> </md-card-title> <md-card-actions layout="row" layout-align="end center">  <md-button class="showMore" ng-click="campaignCtrl.changeView(\'campaignMemberList/ \' + segment.segmentId)">Show Members</md-button> </md-card-actions> </md-card> </div> </md-content> </div> </div>'),a.put("views/campaignMemberList.html",'<table st-table="CampMemberListCtrl.displayedMemberList" st-safe-src="CampMemberListCtrl.memberList" class="table table-striped"> <thead> <tr> <th>Contact Id</th> <th st-sort="C_FirstName" class="sortElement">First name</th> <th st-sort="C_LastName">Last name</th> <th st-sort="C_EmailAddress">E-Mail Address</th> <th st-sort="C_Company">Copmany</th> </tr> <tr> <th></th> <th> <input st-search="C_FirstName" placeholder="search for firstname" class="input-sm form-control" type="search"> </th> <th> <input st-search="C_LastName" placeholder="search for lastname" class="input-sm form-control" type="search"> </th> <th></th> <th></th> </tr> </thead> <tbody> <tr ng-repeat="member in CampMemberListCtrl.displayedMemberList"> <td>{{member.contactId}}</td> <td>{{member.C_FirstName}}</td> <td>{{member.C_LastName}}</td> <td><a ng-href="mailto:{{member.C_EmailAddress}}">{{member.C_EmailAddress}}</a></td> <td>{{member.C_Company}}</td> <td><md-button><i class="material-icons md-24 {{member.buttonStyle}}" ng-click="CampMemberListCtrl.updateMember(member)">{{member.buttonName}}</i></md-button></td> </tr> </tbody> </table>'),a.put("views/main.html",'<div class="jumbotron"> <h1>\'Allo, \'Allo!</h1> <p class="lead"> <img src="images/yeoman.c582c4d1.png" alt="I\'m Yeoman"><br> Always a pleasure scaffolding your apps. </p> <p><a class="btn btn-lg btn-success" ng-href="#/">Splendid!<span class="glyphicon glyphicon-ok"></span></a></p> </div> <div class="row marketing"> <h4>HTML5 Boilerplate</h4> <p> HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites. </p> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div>')}]);